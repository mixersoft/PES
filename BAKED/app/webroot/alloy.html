<!DOCTYPE html>

<html>
<head>
	<script src="http://yui.yahooapis.com/combo?3.3.0/build/yui/yui-min.js" type="text/javascript"></script>
	<script src="dev/alloy-1.0.1/build/aui/aui.js" type="text/javascript"></script>
	<link rel="stylesheet" href="dev/alloy-1.0.1/build/aui-skin-classic/css/aui-skin-classic-all-min.css" type="text/css" media="screen" />

	<style type="text/css">

	</style>
</head>

<body>

<h1>Alloy - IO</h1>

<div id="content1"></div>
<div id="content2"></div>

<script type="text/javascript">
    var namespace = function(){
        var a = arguments, o = null, i, j, d;
        for (i = 0; i < a.length; i = i + 1) {
            d = a[i].split(".");
            o = window;
            for (j = 0; j < d.length; j = j + 1) {
                o[d[j]] = o[d[j]] || {};
                o = o[d[j]];
            }
        }
        return o;
    };	
	var useCombo = 0;
	var host = window.location.host;
	var combo_baseurl = 'app/webroot&';
	namespace('SNAPPI.yuiConfig');
    SNAPPI.yuiConfig.aui = { // GLOBAL
//        base: "http://yui.yahooapis.com/combo?3.3.0/build/", //  local='/svc/yuilib/yui3/'; // or,
        timeout: 10000,
        loadOptional: false,
//        combine: 1,
//        filter: "MIN",
        allowRollup: true,
//		filter: "DEBUG",
//        insertBefore: 'css-start',
		groups: {}
    };	
    SNAPPI.yuiConfig.snappi = {
        combine: useCombo,
        base: 'http://' + host + '/js/snappi/',
        comboBase: 'http://' + host + '/combo/js?baseurl='+combo_baseurl,
        root: 'js/snappi/',						// base for combo loading, combo load uri = comboBase+root+[module-name]
        modules: {
    		'snappi-toolbutton': {
    			path:'toolbuttons.js',
    			requires:['node']
    		},
    		'snappi-property' : {
    			path : 'property.js',
    			requires : ['node', 'base']
    		},
    		'snappi-dialogbox': {
    			path: 'dialogbox.js',
    			requires:['node']
    		},
    		'snappi-dialogboxCfg': {
       			path: 'dialogboxcfg.js',	
       			requires:['node', 'snappi-dialogbox']
       		},
    		'snappi-menu': {
    			path: 'menu.js',
    			requires:['node']
    		},
    		'snappi-menuitem': {
    			path: 'menuitem.js',
    			requires:['node', 'substitute']
    		},
    		'snappi-menucfg': {
    			path: 'menucfg.js',
    			requires:['node', 'node-event-simulate', 'snappi-menu', 'snappi-menuitem']
    		},
    		'snappi-zoom': {
				path: 'zoom.js',
				requires:['node']
			},
            'snappi-tabs': {
                path: 'tabs.js',
                requires: ['node']
            },
            'snappi-sort': {
                path: 'sort.js',
                requires: ['node']
            },
            'snappi-sortedhash': {
                path: 'sortedhash.js',
                requires: ['node', 'snappi-sort', 'gallery-data-element']
            },
            'snappi-dragdrop': {
                path: 'dragdrop3.js',
                requires: ['node', 'event', 'dd', 'dd-delegate', 'dd-plugin', 'dd-drop-plugin', 'anim']
            },
            'snappi-imageloader': {
                path: 'imageloader.js',
                requires: ['node', 'async-queue', 'event'] // also references SNAPPI.util.LoadingPanel
            },
            'snappi-thumbnail': {
                path: 'thumbnail3.js',
                requires: ['node', 'substitute', 'stylesheet', 'event', 'overlay', 'gallery-util', 'gallery-rating', 'gallery-group', 'snappi-dragdrop', 'snappi-imageloader']
                //'gallery-util' SNAPPI.util.hash(bindTo) may be deprecated 
            },
            'snappi-thumbnail-helpers': {
                path: 'thumbnail-helpers.js',
                requires: []
            },                       
            'snappi-photoroll': {
                path: 'photo-roll.js',
                requires: ['node', 'event', 'event-key', 'snappi-utils', 'gallery-rating'] // snappi-util -> SNAPPI.shotController, SNAPPI.ratingManager (move)
            },
            'snappi-domJsBinder': {
                path: 'domJsBinder.js',
                requires: ['node', 'event-custom', 'io', 'gallery-datasource', 'gallery-auditions', 'snappi-sort', 'snappi-photoroll']
            },
            'snappi-lightbox': {
                path: 'lightbox.js',
                requires: ['node', 'substitute', 'event', 'io', 'dd', 'dd-plugin', 'snappi-utils', 'snappi-sortedhash', 'snappi-photoroll', 'snappi-dragdrop', 'snappi-domJsBinder', 'gallery-rating', 'pagemaker-base',
                           /*
                            * experimental
                            */
//                           'yui2-resize'
                           'resize' // yui3 resize
                           ]
                // snappi-util -> SNAPPI.shotController, SNAPPI.ratingManager, SNAPPI.io (move)
            },
            'snappi-utils': {
                path: 'utils.js',
                requires: ['node', 'event-custom', 'io', 'substitute', 'gallery-rating', 'snappi-photoroll', 'snappi-lightbox']
            },
            'snappi-io': {
                path: 'io.js',
                requires: ['node', 'io', 'json']
            },  
            'snappi-io-helpers': {
                path: 'io_helpers.js',
                requires: ['async-queue', 'node', 'substitute', 'snappi-io']
            },           
            'snappi-session': {
                path: 'helper_session.js',
                requires: ['snappi-io']
            },
            'snappi-filter': {
                path: 'filter.js',
                requires: ['node', 'gallery-rating']
            }
        }
    };
    SNAPPI.yuiConfig.gallery = {
        combine: useCombo,
        base: 'http://' + host + '/js/gallery/',
        comboBase: 'http://' + host + '/combo/js?baseurl='+combo_baseurl,
        root: 'js/gallery/',						// base for combo loading, combo load uri = comboBase+root+[module-name]
        modules: {
            'gallery-util': {
                path: 'util.js',
                requires: ['node', 'yui2-container']
            },
            'gallery-rating': {
                path: 'rating.js',
                requires: ['node', 'event', 'stylesheet', 'snappi-thumbnail']
            },
            'gallery-data-element': {
                path: 'dataelement.js',
                requires: ['node', 'yui2-container']
            },
            'gallery-group': {
                path: 'groups3.js',
                requires: ['node', 'snappi-sortedhash', 'snappi-dragdrop']
            },
            'gallery-datasource': {
                path: 'datasource3.js',
                requires: ['node', 'async-queue', 'io', 'datatype-xml', 'gallery-util', 'gallery-data-element', 'gallery-group']
            },
            'gallery-auditions': {
                path: 'auditions.js',
                requires: ['node', 'gallery-util', 'gallery-group', 'snappi-sortedhash']
            }
        }
    };
    SNAPPI.yuiConfig.jsLib = {
        combine: false,
        base: 'http://' + host + '/js/lib/',
        comboBase: null,
        root: 'js/lib/',
        modules: {
            fleegix_xml: {
                path: 'xml.js'
            }
        }
    };
    SNAPPI.yuiConfig.aui = {
        combine: false,
        base: 'dev/alloy-1.0.1/build/',
        comboBase: 'http://' + host + '/combo/js?baseurl=dev/alloy-1.0.1/build&',
        root: '/',
        modules: {
            aui: {
                path: 'aui/aui.js'
            }
        }
    };	
    SNAPPI.yuiConfig.pagemaker = {
        combine: useCombo,
        base: 'http://' + host + '/app/pagemaker/js/create/',
        comboBase: 'http://' + host + '/combo/js?baseurl=PAGEMAKER&',
        root: 'js/create/',
        modules: {
            'pagemaker-base': {
                path: 'base.js',
                requires: ['node', 'io', 'fleegix_xml']
            }
        }
    };
    SNAPPI.yuiConfig.aui.groups.snappi = SNAPPI.yuiConfig.snappi;
    SNAPPI.yuiConfig.aui.groups.gallery2 = SNAPPI.yuiConfig.gallery;
    SNAPPI.yuiConfig.aui.groups.jsLib = SNAPPI.yuiConfig.jsLib;
    SNAPPI.yuiConfig.aui.groups.pagemaker = SNAPPI.yuiConfig.pagemaker;
	SNAPPI.yuiConfig.aui.groups.aui= SNAPPI.yuiConfig.aui;

YUI(SNAPPI.yuiConfig.aui).ready('aui','aui-io-plugin', 'aui-dialog', 
	/*
	 * test snappi load from AUI
	 */
	'snappi-sortedhash',

	/*
	 * 
	 */
	function(A) {

	var content1 = A.one('#content1');

	content1.plug(A.Plugin.IO, {
		uri: 'dev/alloy-1.0.1/demos/io-plugin/assets/content.html',
		method: 'GET',
		data: {
			key1: 'value1',
			key2: 'value2'
		},
		// node: A.one('#content2'), // dont need to pass this
		// showLoading: true,
		// parseContent: true,
		// failureMessage: 'Error!',
		// section: 'body',
		// where: 'REPLACE',
		on: {
			success: function(event) {
				console.log('success user', arguments);

				// event.stopImmediatePropagation();
			},
			complete: function(event) {
				// console.log('complete user', arguments);
				// event.stopImmediatePropagation();
			},
			start: function(event) {
				// console.log('start user', arguments);
				// event.stopImmediatePropagation();
			},
			failure: function(event) {
				// console.log('failure user', arguments);
				// event.stopImmediatePropagation();
			}
		}
	});

	var dialog = new A.Dialog({
		title: 'Testing IO',
		centered: true,
		width: 300,
		bodyContent: 'Loading content via A.Plugin.IO...'
	})
	.render();
console.log(A.Plugin.IO);
	dialog.plug(A.Plugin.IO, {
		uri: 'dev/alloy-1.0.1/demos/io-plugin/assets/content.html'
		// on: {
		// 	success: function(event) {
		// 		console.log('success user', arguments);
		// 		// event.halt();
		// 	},
		// 	complete: function(event) {
		// 		console.log('complete user', arguments);
		// 		// event.halt();
		// 	},
		// 	start: function(event) {
		// 		console.log('start user', arguments);
		// 		// event.halt();
		// 	},
		// 	failure: function(event) {
		// 		console.log('failure user', arguments);
		// 		// event.halt();
		// 	}
		// }
	});

});

</script>

</body>
</html>